# -*- coding: utf-8 -*-
"""
건설업 산업안전보건관리비 사용항목 데이터베이스
근거: 고용노동부고시 제2025-11호 「건설업 산업안전보건관리비 계상 및 사용기준」
시행일: 2025.02.12
"""

# ──────────────────────────────────────────────
# 9대 사용항목 정의 (고시 제7조)
# ──────────────────────────────────────────────
CATEGORIES = {
    1: {
        "name": "안전·보건관리자 등의 인건비 등",
        "description": "안전·보건관리자, 보조원, 유도·신호자, 관리감독자 업무수당, 안전관리 차량 유지비 등",
        "limit": None,
        "legal_basis": "고시 제7조 제1항 제1호",
    },
    2: {
        "name": "안전시설비 등",
        "description": "안전난간, 추락방호망, 방호장치, 가설통로, 채광·조명, 환기, CCTV, 스마트 안전장비, 소화기 등 안전시설 설치·유지·보수·해체 비용",
        "limit": None,
        "legal_basis": "고시 제7조 제1항 제2호",
    },
    3: {
        "name": "보호구 등",
        "description": "안전모, 안전화, 안전장갑, 방진마스크, 방독마스크, 귀마개 등 개인보호구 구입·수리 비용",
        "limit": None,
        "legal_basis": "고시 제7조 제1항 제3호",
    },
    4: {
        "name": "안전보건진단비 등",
        "description": "유해위험방지계획서, 안전보건진단, 작업환경측정, 위험성평가 컨설팅 등",
        "limit": None,
        "legal_basis": "고시 제7조 제1항 제4호",
    },
    5: {
        "name": "안전보건교육비 등",
        "description": "안전보건교육 비용, 교육장 설치, 교육 자료·교재 구입, 안전행사 비용 등",
        "limit": None,
        "legal_basis": "고시 제7조 제1항 제5호",
    },
    6: {
        "name": "근로자 건강장해예방비 등",
        "description": "구급기재, 건강진단, 작업장 방역·소독, 온열·한랭 질환 예방 비용 등",
        "limit": None,
        "legal_basis": "고시 제7조 제1항 제6호",
    },
    7: {
        "name": "건설재해예방전문지도기관의 지도 대가",
        "description": "법 제73조·제74조에 따른 자기공사자의 건설재해예방전문지도기관 지도 비용",
        "limit": None,
        "legal_basis": "고시 제7조 제1항 제7호",
    },
    8: {
        "name": "본사 전담조직 근로자의 임금 및 출장비",
        "description": "법 제72조, 시행령 제59조 및 시행규칙 제89조에 따라 안전보건 업무를 총괄·관리하는 본사 전담조직(3명 이상) 소속 근로자의 임금 및 업무수행 출장비",
        "limit": "안전보건관리비 총액의 5% (1/20)",
        "legal_basis": "고시 제7조 제1항 제8호",
    },
    9: {
        "name": "위험성평가 등에 따른 소요비용",
        "description": "유해·위험요인 개선을 위해 산업안전보건위원회 또는 노사 협의체 등에서 사용하기로 결정한 사항의 이행 비용",
        "limit": "안전보건관리비 총액의 15% (2025년 개정, 기존 10%)",
        "legal_basis": "고시 제7조 제1항 제9호",
    },
}

# ──────────────────────────────────────────────
# 카테고리별 상세 법적 근거
# ──────────────────────────────────────────────
CATEGORY_LEGAL_DETAILS = {
    1: {
        "상위법": "산업안전보건법 제72조 (건설업의 산업안전보건관리비 계상 등)",
        "시행령": "산업안전보건법 시행령 제58조 (건설업 산업안전보건관리비의 계상)",
        "고시": "고용노동부고시 제2025-11호 제7조 제1항 제1호",
        "관련조항": [
            "산업안전보건법 제17조 (안전관리자), 제18조 (보건관리자)",
            "산업안전보건법 제16조 (관리감독자)",
            "산업안전보건법 시행령 제16조 (안전관리자의 선임)",
            "고시 [별표 1의2] 관리감독자 안전보건업무 수행 시 수당지급 작업",
        ],
    },
    2: {
        "상위법": "산업안전보건법 제72조",
        "시행령": "산업안전보건법 시행령 제58조",
        "고시": "고용노동부고시 제2025-11호 제7조 제1항 제2호",
        "관련조항": [
            "산업안전보건법 제36조 (위험성평가)",
            "산업안전보건법 시행규칙 제27조 (추락방호망 설치)",
            "산업안전보건기준에 관한 규칙 제42조 (추락 위험 방지), 제43조 (개구부 등의 방호조치)",
            "산업안전보건기준에 관한 규칙 제304조 (전기 기계·기구의 접지)",
            "고시 부칙 제2조 (스마트 안전장비 경과조치: 2025년 70%, 2026년 100%)",
        ],
    },
    3: {
        "상위법": "산업안전보건법 제72조",
        "시행령": "산업안전보건법 시행령 제58조",
        "고시": "고용노동부고시 제2025-11호 제7조 제1항 제3호",
        "관련조항": [
            "산업안전보건법 제38조 (안전조치) 제1항 제4호 — 보호구 지급 의무",
            "산업안전보건법 시행규칙 제32조 (보호구의 지급 등)",
            "안전인증고시 (고용노동부고시 제2024-58호) — 안전인증 대상 보호구 목록",
            "산업안전보건기준에 관한 규칙 제32조 (보호구의 제한적 사용)",
        ],
    },
    4: {
        "상위법": "산업안전보건법 제72조",
        "시행령": "산업안전보건법 시행령 제58조",
        "고시": "고용노동부고시 제2025-11호 제7조 제1항 제4호",
        "관련조항": [
            "산업안전보건법 제42조 (유해위험방지계획서 작성·제출)",
            "산업안전보건법 제49조 (안전보건진단)",
            "산업안전보건법 제125조 (작업환경측정)",
            "산업안전보건법 제36조 (위험성평가)",
        ],
    },
    5: {
        "상위법": "산업안전보건법 제72조",
        "시행령": "산업안전보건법 시행령 제58조",
        "고시": "고용노동부고시 제2025-11호 제7조 제1항 제5호",
        "관련조항": [
            "산업안전보건법 제29조 (근로자에 대한 안전보건교육)",
            "산업안전보건법 제31조 (건설업 기초안전보건교육)",
            "산업안전보건법 시행규칙 제26조 (교육시간 및 내용)",
        ],
    },
    6: {
        "상위법": "산업안전보건법 제72조",
        "시행령": "산업안전보건법 시행령 제58조",
        "고시": "고용노동부고시 제2025-11호 제7조 제1항 제6호",
        "관련조항": [
            "산업안전보건법 제129조 (일반건강진단), 제130조 (특수건강진단)",
            "산업안전보건기준에 관한 규칙 제559조 (온도·습도 조절) — 온열질환 예방",
            "고시 부칙 — 2025년 신설: 온열·한랭 질환 예방 비용 추가",
        ],
    },
    7: {
        "상위법": "산업안전보건법 제73조 (건설재해예방전문지도기관), 제74조 (지도의 수행)",
        "시행령": "산업안전보건법 시행령 제60조~제62조",
        "고시": "고용노동부고시 제2025-11호 제7조 제1항 제7호",
        "관련조항": [
            "※ 2022.08.18부터 발주자 계약으로 이관 (수급인 사용 제한)",
        ],
    },
    8: {
        "상위법": "산업안전보건법 제72조",
        "시행령": "산업안전보건법 시행령 제59조 (안전보건 총괄 전담조직)",
        "고시": "고용노동부고시 제2025-11호 제7조 제1항 제8호",
        "관련조항": [
            "산업안전보건법 시행규칙 제89조 (본사 전담조직 구성 기준)",
            "한도: 계상된 안전보건관리비 총액의 1/20(5%) 이내",
        ],
    },
    9: {
        "상위법": "산업안전보건법 제72조",
        "시행령": "산업안전보건법 시행령 제58조",
        "고시": "고용노동부고시 제2025-11호 제7조 제1항 제9호",
        "관련조항": [
            "산업안전보건법 제36조 (위험성평가)",
            "산업안전보건법 제24조 (산업안전보건위원회)",
            "한도: 계상된 안전보건관리비 총액의 15% 이내 (2025년 개정, 기존 10%)",
        ],
    },
}

# ──────────────────────────────────────────────
# 사용 가능 물품 데이터
# status: "allowed" | "conditional" | "prohibited"
# ──────────────────────────────────────────────
ITEMS = [
    # ── 항목 1: 안전·보건관리자 인건비 등 ──
    {"name": "안전관리자 인건비", "category": 1, "status": "allowed",
     "keywords": ["안전관리자", "인건비", "안전담당자"],
     "note": "안전관리 업무 전담자에 한함"},
    {"name": "보건관리자 인건비", "category": 1, "status": "allowed",
     "keywords": ["보건관리자", "인건비"],
     "note": "보건관리 업무 전담자에 한함"},
    {"name": "안전보조원 인건비", "category": 1, "status": "allowed",
     "keywords": ["안전보조원", "보조원", "안전순찰"],
     "note": "안전순찰·질병자 관리 등 안전·보건관리업무만을 전담하는 보조원"},
    {"name": "유도·신호자 인건비", "category": 1, "status": "allowed",
     "keywords": ["유도자", "신호자", "신호수", "신호원"],
     "note": "공사장 내 근로자 보호를 위한 신호자 (공사 도급내역서에 미반영 시에 한함)"},
    {"name": "관리감독자 업무수당", "category": 1, "status": "allowed",
     "keywords": ["관리감독자", "업무수당", "수당"],
     "note": "월 급여액의 10% 이내, 별표 1의2에 해당하는 위험 작업에 한함"},
    {"name": "안전관리 차량 유류비", "category": 1, "status": "allowed",
     "keywords": ["유류비", "차량", "기름값", "주유"],
     "note": "안전관리자 등이 안전보건 점검 목적으로 현장에서 사용하는 차량에 한함"},
    {"name": "안전관리 차량 수리비", "category": 1, "status": "allowed",
     "keywords": ["차량수리", "수리비"],
     "note": "안전관리자 등 업무용 차량에 한함"},
    {"name": "안전관리 차량 보험료", "category": 1, "status": "allowed",
     "keywords": ["차량보험", "보험료"],
     "note": "안전관리자 등 업무용 차량에 한함"},
    {"name": "안전관리자 출장비", "category": 1, "status": "allowed",
     "keywords": ["출장비", "출장", "교통비"],
     "note": "업무수행 출장비"},

    # ── 항목 2: 안전시설비 등 ──
    {"name": "안전난간", "category": 2, "status": "allowed",
     "keywords": ["안전난간", "난간", "가드레일", "핸드레일"],
     "note": "추락 방지용 안전시설"},
    {"name": "추락방호망", "category": 2, "status": "allowed",
     "keywords": ["추락방호망", "방호망", "안전망", "네트"],
     "note": "추락 방지 목적의 안전시설"},
    {"name": "안전대 부착설비", "category": 2, "status": "allowed",
     "keywords": ["안전대", "부착설비", "안전줄", "안전로프", "라이프라인"],
     "note": "구조검토 및 안전인증 필요"},
    {"name": "방호장치", "category": 2, "status": "allowed",
     "keywords": ["방호장치", "방호커버", "안전커버"],
     "note": "일체형인 경우 부분가액만 인정"},
    {"name": "가설통로", "category": 2, "status": "allowed",
     "keywords": ["가설통로", "임시통로", "가설계단", "사다리"],
     "note": "작업자 이동을 위한 안전한 통로"},
    {"name": "채광·조명시설", "category": 2, "status": "allowed",
     "keywords": ["조명", "채광", "투광기", "작업등", "라이트"],
     "note": "작업장 안전을 위한 채광·조명 설비"},
    {"name": "환기시설", "category": 2, "status": "allowed",
     "keywords": ["환기", "환풍기", "송풍기", "급·배기장치"],
     "note": "밀폐공간 작업 등 환기 목적"},
    {"name": "건조시설", "category": 2, "status": "allowed",
     "keywords": ["건조시설", "건조기"],
     "note": "작업 환경 관련 건조 시설"},
    {"name": "소음감소시설", "category": 2, "status": "allowed",
     "keywords": ["소음", "방음", "차음", "방음벽"],
     "note": "근로자 소음 노출 저감 목적"},
    {"name": "소화기", "category": 2, "status": "allowed",
     "keywords": ["소화기", "분말소화기", "이산화탄소소화기", "ABC소화기"],
     "note": "화재 위험작업 시 사용 장비"},
    {"name": "불티방지포", "category": 2, "status": "allowed",
     "keywords": ["불티방지포", "방화포", "용접방화포", "스파크시트"],
     "note": "화재 위험작업 시 사용"},
    {"name": "CCTV (안전감시용)", "category": 2, "status": "conditional",
     "keywords": ["CCTV", "감시카메라", "폐쇄회로", "안전카메라"],
     "note": "⚠️ 근로자 안전작업 수행 여부 확인 및 관리감독 목적에 한함. 공사 목적물 품질 확보, 건설장비 운행 감시 등 다른 목적이 포함되면 사용 불가"},
    {"name": "스마트 안전장비", "category": 2, "status": "allowed",
     "keywords": ["스마트", "IoT", "웨어러블", "스마트안전", "안전센서"],
     "note": "2025년: 70% 인정, 2026년 1월 1일부터: 100% 인정. 총액의 20% 한도"},
    {"name": "누전차단기", "category": 2, "status": "allowed",
     "keywords": ["누전차단기", "차단기", "ELCB", "RCD"],
     "note": "가설 전기시설용"},
    {"name": "접지시설", "category": 2, "status": "allowed",
     "keywords": ["접지", "접지봉", "접지시설", "어스"],
     "note": "가설 전기시설용"},
    {"name": "소화설비 및 방화사", "category": 2, "status": "allowed",
     "keywords": ["소화설비", "방화사", "스프링클러"],
     "note": "화재 예방 시설"},
    {"name": "누전·화재경보기", "category": 2, "status": "allowed",
     "keywords": ["화재경보기", "누전경보", "감지기", "화재감지", "연기감지"],
     "note": "가설사무실·숙소 등에 설치"},
    {"name": "돌출부 찔림 방지용 캡", "category": 2, "status": "allowed",
     "keywords": ["캡", "철근캡", "보호캡", "찔림방지"],
     "note": "철근 등 돌출부 위험 방지"},
    {"name": "위험물 방호시설 및 저장소", "category": 2, "status": "allowed",
     "keywords": ["위험물", "저장소", "방호시설", "가스용기", "산소용기"],
     "note": "고압가스·산소용기 등 위험물 보관 시설"},
    {"name": "개인보호구 보관시설", "category": 2, "status": "allowed",
     "keywords": ["보관시설", "보호구함", "보관함"],
     "note": "개인보호구를 보관하기 위한 시설"},
    {"name": "안전시설물 설치·해체 인건비", "category": 2, "status": "allowed",
     "keywords": ["설치인건비", "해체인건비"],
     "note": "안전시설 설치·유지·보수·해체에 소요되는 인건비 및 제비용"},
    {"name": "전용 교육장 냉난방기", "category": 2, "status": "conditional",
     "keywords": ["냉난방기", "냉방기", "난방기", "에어컨", "히터"],
     "note": "⚠️ 혹한기·혹서기에 한하며, 전용 교육장 및 현장 간이 휴게실용에 한함"},
    {"name": "비계", "category": 2, "status": "allowed",
     "keywords": ["비계", "시스템비계", "강관비계", "틀비계", "이동식비계"],
     "note": "안전작업용 비계 (공사 도급내역서 별도 반영 시 제외)"},
    {"name": "안전표지판", "category": 2, "status": "allowed",
     "keywords": ["안전표지", "경고표지", "금지표지", "지시표지", "안내표지"],
     "note": "산업안전보건법에 따른 안전·보건표지"},
    {"name": "이동식 화장실", "category": 2, "status": "conditional",
     "keywords": ["이동식화장실", "간이화장실", "포터블화장실"],
     "note": "⚠️ 근로자 위생 목적. 위험성평가 결과에 따라 항목 9로 사용 가능"},

    # ── 항목 3: 보호구 등 ──
    {"name": "안전모", "category": 3, "status": "allowed",
     "keywords": ["안전모", "헬멧", "보안모", "안전헬멧", "하드햇"],
     "note": "안전인증 받은 품목에 한함"},
    {"name": "안전화", "category": 3, "status": "allowed",
     "keywords": ["안전화", "안전신발", "작업화", "안전부츠"],
     "note": "안전인증 받은 품목에 한함"},
    {"name": "안전장갑", "category": 3, "status": "allowed",
     "keywords": ["안전장갑", "보호장갑", "절연장갑", "방진장갑", "내화학장갑"],
     "note": "안전인증 받은 품목 (면장갑·코팅장갑은 불가)"},
    {"name": "보안경", "category": 3, "status": "allowed",
     "keywords": ["보안경", "안전안경", "보호안경", "차광안경"],
     "note": "안전인증 받은 품목"},
    {"name": "보안면", "category": 3, "status": "allowed",
     "keywords": ["보안면", "안전면", "페이스실드", "용접면"],
     "note": "안전인증 받은 품목"},
    {"name": "안전대 (안전벨트)", "category": 3, "status": "allowed",
     "keywords": ["안전대", "안전벨트", "하네스", "안전그네"],
     "note": "안전인증 받은 품목"},
    {"name": "방진마스크", "category": 3, "status": "allowed",
     "keywords": ["방진마스크", "분진마스크", "미세먼지마스크"],
     "note": "안전인증 받은 품목"},
    {"name": "방독마스크", "category": 3, "status": "allowed",
     "keywords": ["방독마스크", "가스마스크", "유기용제마스크"],
     "note": "안전인증 받은 품목"},
    {"name": "송기마스크", "category": 3, "status": "allowed",
     "keywords": ["송기마스크", "에어라인마스크"],
     "note": "밀폐공간 작업 시"},
    {"name": "귀마개", "category": 3, "status": "allowed",
     "keywords": ["귀마개", "이어플러그"],
     "note": "소음 노출 근로자 보호"},
    {"name": "귀덮개", "category": 3, "status": "allowed",
     "keywords": ["귀덮개", "이어머프"],
     "note": "소음 노출 근로자 보호"},
    {"name": "산소호흡기", "category": 3, "status": "allowed",
     "keywords": ["산소호흡기", "자급식호흡기"],
     "note": "밀폐공간 작업 등"},
    {"name": "공기호흡기 (SCBA)", "category": 3, "status": "allowed",
     "keywords": ["공기호흡기", "SCBA", "에어팩"],
     "note": "밀폐공간·유해가스 작업"},
    {"name": "차광보안경", "category": 3, "status": "allowed",
     "keywords": ["차광보안경", "차광안경", "용접안경"],
     "note": "용접 등 강렬한 빛 작업"},
    {"name": "용접용 앞치마", "category": 3, "status": "allowed",
     "keywords": ["앞치마", "용접앞치마", "가죽앞치마", "방화앞치마"],
     "note": "용접 작업 시 보호"},
    {"name": "용접용 토시 (자켓)", "category": 3, "status": "allowed",
     "keywords": ["토시", "용접토시", "팔보호대", "용접자켓"],
     "note": "용접 작업 시 보호구"},
    {"name": "구명조끼", "category": 3, "status": "allowed",
     "keywords": ["구명조끼", "라이프재킷", "구명복"],
     "note": "해상·수상공사 시"},
    {"name": "구명튜브", "category": 3, "status": "allowed",
     "keywords": ["구명튜브", "구명환"],
     "note": "해상·수상공사 시"},
    {"name": "안전화 건조기", "category": 3, "status": "allowed",
     "keywords": ["안전화건조기", "신발건조기"],
     "note": "안전화 관리용"},
    {"name": "절연장화", "category": 3, "status": "allowed",
     "keywords": ["절연장화", "절연부츠"],
     "note": "전기 작업 시 보호"},
    {"name": "절연장갑", "category": 3, "status": "allowed",
     "keywords": ["절연장갑", "전기장갑"],
     "note": "전기 작업 시 보호"},
    {"name": "방전고무장갑", "category": 3, "status": "allowed",
     "keywords": ["방전장갑", "고무장갑"],
     "note": "전기 작업 시 보호"},
    {"name": "고무소매·절연의", "category": 3, "status": "allowed",
     "keywords": ["고무소매", "절연의", "절연복"],
     "note": "전기 작업 시 보호구"},
    {"name": "방염처리 작업복", "category": 3, "status": "allowed",
     "keywords": ["방염작업복", "방염복", "내화복"],
     "note": "화재 위험 작업 시"},
    {"name": "철골·철탑 작업용 특수화", "category": 3, "status": "allowed",
     "keywords": ["특수화", "고무바닥신발", "철골신발"],
     "note": "고무바닥 특수화"},
    {"name": "조임대 (각반)", "category": 3, "status": "allowed",
     "keywords": ["각반", "조임대", "레깅스"],
     "note": "작업 시 보호용"},
    {"name": "우의", "category": 3, "status": "allowed",
     "keywords": ["우의", "비옷", "레인코트"],
     "note": "우천 시 작업 보호"},
    {"name": "장화 (습지용)", "category": 3, "status": "allowed",
     "keywords": ["장화", "고무장화", "방수부츠"],
     "note": "습지 장소 작업 시"},
    {"name": "신호수용 반사조끼", "category": 3, "status": "allowed",
     "keywords": ["반사조끼", "안전조끼", "야광조끼"],
     "note": "신호수·안전관계자용"},
    {"name": "안전관리자 업무용 피복", "category": 3, "status": "allowed",
     "keywords": ["업무용피복", "유니폼", "작업복"],
     "note": "안전관리자 등의 업무용 피복에 한함 (일반 작업복 불가)"},
    {"name": "감염병 예방 마스크", "category": 3, "status": "allowed",
     "keywords": ["KF94", "KF80", "보건마스크"],
     "note": "감염병 예방 목적의 보건용 마스크"},
    {"name": "손소독제", "category": 3, "status": "allowed",
     "keywords": ["손소독제", "손세정제", "핸드사니타이저"],
     "note": "감염병 예방 물품"},
    {"name": "안전관리자 업무용 무전기", "category": 3, "status": "allowed",
     "keywords": ["무전기", "워키토키", "통신기"],
     "note": "안전관리자 등의 업무용"},
    {"name": "안전관리자 업무용 카메라", "category": 3, "status": "conditional",
     "keywords": ["카메라", "디카"],
     "note": "⚠️ 안전관리자 등의 업무용에 한함. 일반 업무용은 불가"},
    {"name": "안전관리자 업무용 컴퓨터", "category": 3, "status": "conditional",
     "keywords": ["컴퓨터", "노트북", "PC"],
     "note": "⚠️ 안전관리자 등의 안전 업무 전용에 한함"},
    {"name": "안전관리자 업무용 프린터", "category": 3, "status": "conditional",
     "keywords": ["프린터", "복합기", "인쇄기"],
     "note": "⚠️ 안전관리자 등의 안전 업무 전용에 한함. 일반 사무용은 불가"},

    # ── 항목 4: 안전보건진단비 등 ──
    {"name": "유해위험방지계획서 작성·심사·확인 비용", "category": 4, "status": "allowed",
     "keywords": ["유해위험방지계획서", "방지계획서"],
     "note": "법정 의무 비용"},
    {"name": "안전보건진단 비용", "category": 4, "status": "allowed",
     "keywords": ["안전진단", "보건진단", "안전보건진단"],
     "note": "법 제49조에 따른 진단기관 또는 외부 안전전문가의 진단"},
    {"name": "작업환경측정 비용", "category": 4, "status": "allowed",
     "keywords": ["작업환경측정", "환경측정"],
     "note": "법정 의무 비용"},
    {"name": "산소농도측정기", "category": 4, "status": "allowed",
     "keywords": ["산소측정기", "O2측정기", "산소농도"],
     "note": "밀폐공간 작업 필수 장비"},
    {"name": "가스자동측정기 (휴대용)", "category": 4, "status": "allowed",
     "keywords": ["가스측정기", "가스탐지기", "가스감지기", "4가스측정기"],
     "note": "유해가스 측정용"},
    {"name": "일산화탄소 측정기", "category": 4, "status": "allowed",
     "keywords": ["일산화탄소", "CO측정기", "CO감지기"],
     "note": "유해가스 측정용"},
    {"name": "활선근접 작업경보기", "category": 4, "status": "allowed",
     "keywords": ["활선경보기", "전기경보기", "활선감지"],
     "note": "전기 작업 안전장비"},
    {"name": "조도계", "category": 4, "status": "allowed",
     "keywords": ["조도계", "조도측정기", "럭스미터"],
     "note": "작업장 조도 측정"},
    {"name": "누전측정기", "category": 4, "status": "allowed",
     "keywords": ["누전측정기", "누전검출기", "절연저항계"],
     "note": "전기시설 안전 점검"},
    {"name": "풍속계 (고소작업용)", "category": 4, "status": "allowed",
     "keywords": ["풍속계", "풍속측정기", "바람측정"],
     "note": "고소작업장 강풍 여부 측정용"},
    {"name": "위험성평가 컨설팅 비용", "category": 4, "status": "allowed",
     "keywords": ["위험성평가", "컨설팅", "리스크평가"],
     "note": "전문기관의 위험성평가 컨설팅"},
    {"name": "타워크레인 검사 비용", "category": 4, "status": "allowed",
     "keywords": ["타워크레인검사", "크레인검사", "타워크레인"],
     "note": "법정 검사 비용"},
    {"name": "전기·기계 정밀안전진단", "category": 4, "status": "allowed",
     "keywords": ["정밀안전진단", "전기진단", "기계진단"],
     "note": "전문기관 진단 비용"},

    # ── 항목 5: 안전보건교육비 등 ──
    {"name": "안전보건교육 비용", "category": 5, "status": "allowed",
     "keywords": ["안전교육", "보건교육", "교육비", "안전보건교육"],
     "note": "법정·자율 안전보건 교육"},
    {"name": "기초안전보건교육 비용", "category": 5, "status": "allowed",
     "keywords": ["기초안전교육", "기초교육"],
     "note": "교육비·출장비·수당 포함"},
    {"name": "교육장 컨테이너 렌탈", "category": 5, "status": "allowed",
     "keywords": ["교육장", "컨테이너", "교육실"],
     "note": "현장 내 안전교육장 설치 비용"},
    {"name": "교육장 비품 (책상·의자)", "category": 5, "status": "allowed",
     "keywords": ["책상", "의자", "교육비품"],
     "note": "안전교육장 내 비품에 한함"},
    {"name": "교육장 빔프로젝터·PC", "category": 5, "status": "allowed",
     "keywords": ["빔프로젝터", "프로젝터", "교육PC"],
     "note": "안전교육장 내 교육시설에 한함"},
    {"name": "안전교육 교재·도서", "category": 5, "status": "allowed",
     "keywords": ["교재", "안전도서", "교육자료", "안전책"],
     "note": "의무·자율 안전교육 교재"},
    {"name": "안전보건행사 기념품", "category": 5, "status": "conditional",
     "keywords": ["기념품", "안전행사", "보건행사"],
     "note": "⚠️ 안전보건행사 참여 근로자에 한함. 모든 근로자에 일률적 지급은 불가"},
    {"name": "안전보건행사 식음료", "category": 5, "status": "conditional",
     "keywords": ["식음료", "다과", "행사음식"],
     "note": "⚠️ 안전보건행사 참여 근로자에게 제공하는 것에 한함"},
    {"name": "TBM 방송용 앰프", "category": 5, "status": "conditional",
     "keywords": ["앰프", "앰프스피커", "방송앰프", "TBM", "TBM앰프", "방송장비"],
     "note": "⚠️ TBM(작업 전 안전점검회의) 및 안전보건교육 전용 목적에 한함. '교육용 비품 및 장비'에 해당. 공사 목적물 관리·일반 업무용 방송은 불가. 해당 지역 노동지청에 사전 질의 권장"},
    {"name": "TBM·안전교육용 마이크", "category": 5, "status": "conditional",
     "keywords": ["마이크", "핸드마이크", "무선마이크", "방송마이크"],
     "note": "⚠️ TBM·안전보건교육 전용. '교육용 비품 및 장비'에 해당. 순수 안전교육 목적 사용 입증 필요"},
    {"name": "TBM·안전교육용 확성기 (메가폰)", "category": 5, "status": "conditional",
     "keywords": ["확성기", "메가폰", "스피커", "휴대용확성기"],
     "note": "⚠️ TBM·안전보건교육·긴급대피 방송 목적에 한함. 일반 작업 지시용은 불가"},

    # ── 항목 6: 근로자 건강장해예방비 등 ──
    {"name": "구급기재 (구급상자)", "category": 6, "status": "allowed",
     "keywords": ["구급상자", "구급함", "구급기재", "응급키트", "구급약품"],
     "note": "현장 의무 비치 품목"},
    {"name": "건강진단 비용 (일반·특수)", "category": 6, "status": "allowed",
     "keywords": ["건강진단", "건강검진", "특수검진"],
     "note": "의료보험 적용 제외분에 한함"},
    {"name": "신규 채용 신체검사비", "category": 6, "status": "allowed",
     "keywords": ["신체검사", "채용검진", "채용검사"],
     "note": "신규 채용 시 신체검사 비용"},
    {"name": "작업장 방역·소독비", "category": 6, "status": "allowed",
     "keywords": ["방역", "소독", "방역소독", "살균"],
     "note": "작업장 위생 관리"},
    {"name": "방충비", "category": 6, "status": "allowed",
     "keywords": ["방충", "해충", "살충", "모기약"],
     "note": "작업장 위생 관리"},
    {"name": "탈수 방지 소금 정제", "category": 6, "status": "allowed",
     "keywords": ["소금정제", "소금", "전해질", "탈수방지"],
     "note": "혹서기 근로자 건강 관리"},
    {"name": "중대재해 심리치료 비용", "category": 6, "status": "allowed",
     "keywords": ["심리치료", "PTSD", "정신건강", "심리상담"],
     "note": "중대재해 목격에 따른 심리치료"},
    {"name": "생수병 (혹서기)", "category": 6, "status": "conditional",
     "keywords": ["생수", "물", "음료수", "식수"],
     "note": "⚠️ 혹서기에 한하며, 위험성평가 및 노사협의체 결정 시에만 인정"},
    {"name": "간이 휴게시설 설치·해체·임대", "category": 6, "status": "allowed",
     "keywords": ["휴게시설", "간이휴게소", "쉼터", "그늘막"],
     "note": "2025년 신설: 온열·한랭 질환 예방 목적"},
    {"name": "냉·난방기기 임대 (휴게시설용)", "category": 6, "status": "allowed",
     "keywords": ["냉방기", "난방기", "에어컨", "히터", "선풍기"],
     "note": "2025년 신설: 온열·한랭 질환 예방 비용 (간이 휴게시설용)"},

    # ── 항목 7: 건설재해예방전문지도기관 ──
    {"name": "건설재해예방전문지도기관 지도 비용", "category": 7, "status": "conditional",
     "keywords": ["기술지도", "전문지도기관", "재해예방"],
     "note": "⚠️ 자기공사자에 한함. 2022.08.18부터 발주자 계약으로 이관되어 수급인 사용 불가"},

    # ── 항목 8: 본사 전담조직 ──
    {"name": "본사 전담조직 근로자 임금", "category": 8, "status": "allowed",
     "keywords": ["본사전담", "전담조직", "본사안전"],
     "note": "3명 이상 구성, 안전보건관리비 총액의 5%(1/20) 한도"},
    {"name": "본사 전담조직 출장비", "category": 8, "status": "allowed",
     "keywords": ["본사출장", "전담출장"],
     "note": "업무수행 출장비, 총액의 5% 한도"},

    # ── 항목 9: 위험성평가 등 ──
    {"name": "위험성평가 개선 비용", "category": 9, "status": "allowed",
     "keywords": ["위험성평가", "개선비용", "안전개선"],
     "note": "노사 협의체에서 결정한 사항 이행 비용, 총액의 15% 한도 (2025년 개정)"},
]

# ──────────────────────────────────────────────
# 사용 불가 항목
# ──────────────────────────────────────────────
PROHIBITED_ITEMS = [
    {"name": "경비원 인건비", "category": None, "reason": "안전보건 업무 전담자가 아닌 일반 경비 인력",
     "keywords": ["경비원", "경비", "보안요원"]},
    {"name": "청소원 인건비", "category": None, "reason": "안전보건 업무 전담자가 아닌 일반 청소 인력",
     "keywords": ["청소원", "청소", "미화원"]},
    {"name": "폐자재 처리원 인건비", "category": None, "reason": "안전보건 업무와 직접 관련 없음",
     "keywords": ["폐자재", "폐기물처리"]},
    {"name": "사무보조원 인건비", "category": None, "reason": "안전보건 업무 전담자가 아닌 일반 사무 인력",
     "keywords": ["사무보조", "사무원"]},
    {"name": "복리후생비 (급식, 학자금 등)", "category": None,
     "reason": "임금 중 사택, 급식, 학자금, 보조금 등 복리후생성 비용은 안전관리비 사용 불가",
     "keywords": ["급식", "학자금", "사택", "보조금", "복리후생"]},
    {"name": "면장갑 / 코팅장갑", "category": None,
     "reason": "안전인증 대상이 아닌 일반 작업용 장갑",
     "keywords": ["면장갑", "코팅장갑", "목장갑"]},
    {"name": "일반 작업복", "category": None,
     "reason": "안전 목적이 아닌 일반 작업복은 사용 불가 (방염복 등은 가능)",
     "keywords": ["일반작업복"]},
    {"name": "안전모 턱끈", "category": None,
     "reason": "안전인증 대상에서 제외되는 물품",
     "keywords": ["턱끈", "턱끈만별도"]},
    {"name": "커피·다과 (일상용)", "category": None,
     "reason": "복리후생 목적으로 판단. 안전행사 참여자에 한한 식음료와 구분",
     "keywords": ["커피", "다과", "음료"]},
    {"name": "사무용품 (일반)", "category": None,
     "reason": "일반 사무용품은 안전관리비 사용 불가",
     "keywords": ["사무용품", "문구", "볼펜", "노트"]},
    {"name": "라바콘·PE드럼통 (도로 교통통제용)", "category": None,
     "reason": "도로 교통통제 목적의 시설물은 사용 불가 (공사장 내 안전 목적은 별도 확인)",
     "keywords": ["라바콘", "PE드럼", "차선규제"]},
    {"name": "수신호기 (도로용)", "category": None,
     "reason": "도로 교통통제 목적은 사용 불가",
     "keywords": ["수신호기", "교통봉"]},
    {"name": "차선 오뚜기 (도로용)", "category": None,
     "reason": "도로 교통통제 시설",
     "keywords": ["오뚜기", "차선분리"]},
    {"name": "순시선·구명정", "category": None,
     "reason": "선박 관련 비용은 안전관리비 사용 불가",
     "keywords": ["순시선", "구명정", "보트"]},
    {"name": "살수차 이용비", "category": None,
     "reason": "환경 관리 목적 (타 법령 영역). 단, 미세먼지 마스크는 예외적 허용",
     "keywords": ["살수차", "살수"]},
    {"name": "안전관리계획서 작성비", "category": None,
     "reason": "건설기술진흥법에 따른 비용으로 타 법령 사항",
     "keywords": ["안전관리계획서"]},
    {"name": "안전보건대장 작성비", "category": None,
     "reason": "타 법령에 의한 비용",
     "keywords": ["안전보건대장"]},
    {"name": "의자·침대 (비안전용)", "category": None,
     "reason": "안전과 무관한 일반 비품 (교육장용 의자는 항목 5로 가능)",
     "keywords": ["침대", "소파"]},
    {"name": "기념품 (일괄 지급)", "category": None,
     "reason": "모든 근로자에게 일률적으로 지급하는 기념품은 불가 (안전행사 참여자 한정은 가능)",
     "keywords": ["기념품일괄"]},
    {"name": "임원·방문객용 안전장구", "category": None,
     "reason": "현장 근로자 보호가 아닌 방문객 편의 목적",
     "keywords": ["방문객", "임원용"]},
    {"name": "공구류 (일반)", "category": None,
     "reason": "일반 공구는 공사비에서 처리. 안전 목적 전용 장비와 구분",
     "keywords": ["공구", "드릴", "렌치", "해머"]},
]

# ──────────────────────────────────────────────
# 2025-2026 주요 변경사항
# ──────────────────────────────────────────────
CHANGES_2025_2026 = [
    {
        "year": "2025",
        "title": "계상 요율 인상",
        "detail": "산업안전보건관리비 계상 요율 평균 19% 인상 (공사 종류별 차등 적용)",
        "legal_basis": "고용노동부고시 제2025-11호",
    },
    {
        "year": "2025",
        "title": "스마트 안전장비 지원 확대",
        "detail": "스마트 안전장비 구입·임대 비용 70% 인정 (기존 일부만 인정). 사용 한도 10% → 20%로 상향",
        "legal_basis": "고시 제7조 제1항 제2호",
    },
    {
        "year": "2025",
        "title": "위험성평가 비용 한도 상향",
        "detail": "위험성평가 관련 비용(항목 9) 사용 한도: 10% → 15%로 확대. 안전보건위원회 미설치 현장에서도 근로자 의견 반영 협의체 결정 인정",
        "legal_basis": "고시 제7조 제1항 제9호",
    },
    {
        "year": "2025",
        "title": "온열·한랭 질환 예방 비용 추가",
        "detail": "임시 휴게시설 설치·해체·임대 비용, 냉·난방기기 임대 비용이 안전관리비 사용 가능 항목으로 신설",
        "legal_basis": "고시 제7조 제1항 제6호",
    },
    {
        "year": "2025",
        "title": "교육 비용 인정 확대",
        "detail": "산업재해 예방이 주된 목적인 교육에 소요되는 비용 인정 범위 확대",
        "legal_basis": "고시 제7조 제1항 제5호",
    },
    {
        "year": "2025",
        "title": "적용 범위 확대",
        "detail": "총 공사금액 2천만 원 이상인 건설공사에 적용. 연간 단가계약 공사의 경우 총 계약금액 기준 적용",
        "legal_basis": "고시 제3조",
    },
    {
        "year": "2025",
        "title": "전기·정보통신공사 별도 규정 삭제",
        "detail": "2025년부터 전기공사 및 정보통신공사에 대한 별도 규정이 삭제됨",
        "legal_basis": "고용노동부고시 제2025-11호",
    },
    {
        "year": "2026",
        "title": "스마트 안전장비 전액 지원",
        "detail": "2026년 1월 1일부터 스마트 안전장비 구입·임대 비용 100% 인정 (기존 70%)",
        "legal_basis": "고시 제7조 제1항 제2호 부칙",
    },
]

# ──────────────────────────────────────────────
# 관련 판례 및 주요 사례
# ──────────────────────────────────────────────
CASES_AND_PRECEDENTS = [
    {
        "title": "대법원 2015다214691 판결",
        "type": "판례",
        "summary": "미사용 산업안전보건관리비 반환 의무에 관한 판결. 원청이 하청에 안전보건관리비를 지급했으나 하청이 미사용한 경우, 정산 약정이 없더라도 도급인에게 반환해야 한다고 판시.",
        "key_point": "산업안전보건법 제72조에 따라 안전관리비는 법정 기준에 따라 계상·집행해야 할 의무가 있으며, 고시 제8조가 대외적 구속력을 가짐",
    },
    {
        "title": "프린터·커피·일반마스크 구매 과태료 사례",
        "type": "적발사례",
        "summary": "안전관리비로 프린터, 커피, 일반 마스크, 사무용품 등을 구매한 경우 부적정 사용으로 과태료가 부과된 사례",
        "key_point": "안전과 직접 관련이 없는 물품은 구매 불가. 목적 외 사용 시 과태료 부과",
    },
    {
        "title": "타 현장 전용 적발 사례",
        "type": "적발사례",
        "summary": "A 현장에서 구입한 안전화·안전모 등을 B 현장 근로자에게 지급한 경우 부적정 사용으로 적발",
        "key_point": "해당 현장 근로자 보호 목적으로만 사용해야 하며, 타 현장 전용은 불가",
    },
    {
        "title": "허위 증빙 적발 사례",
        "type": "적발사례",
        "summary": "안전관리비 청구 시 타 현장 증빙 사진 복사, 전자세금계산서 승인번호 위조 등 허위 증빙으로 적발",
        "key_point": "고의적 허위 사용·증빙 시 1년 이하 징역 또는 1천만 원 이하 벌금 가능",
    },
    {
        "title": "기념품 일괄 지급 적발 사례",
        "type": "적발사례",
        "summary": "임원 등 방문객 안전장구 구입, 의자·공구·침대 등 구입이 부적정 사용으로 적발",
        "key_point": "안전과 무관한 물품, 방문객 편의 목적 구입은 불가",
    },
    {
        "title": "공사 도급내역서 중복 반영 사례",
        "type": "적발사례",
        "summary": "공사 도급내역서에 이미 반영된 항목(예: 신호수 인건비)을 안전관리비로 중복 사용하여 적발",
        "key_point": "도급내역서에 반영된 항목은 안전관리비 사용 불가. 다른 법령 의무사항도 마찬가지",
    },
]

# ──────────────────────────────────────────────
# 검색 함수
# ──────────────────────────────────────────────
def search_items(query: str):
    """물품명으로 검색하여 사용 가능 여부를 반환합니다."""
    query_lower = query.strip().lower()
    if not query_lower:
        return {"allowed": [], "conditional": [], "prohibited": []}

    results = {"allowed": [], "conditional": [], "prohibited": []}

    # 사용 가능/조건부 항목 검색
    for item in ITEMS:
        name_match = query_lower in item["name"].lower()
        keyword_match = any(query_lower in kw.lower() for kw in item["keywords"])
        if name_match or keyword_match:
            cat = CATEGORIES[item["category"]]
            legal_detail = CATEGORY_LEGAL_DETAILS.get(item["category"], {})
            result = {
                "name": item["name"],
                "status": item["status"],
                "category_id": item["category"],
                "category_name": cat["name"],
                "note": item["note"],
                "legal_basis": cat["legal_basis"],
                "limit": cat.get("limit"),
                "legal_detail": legal_detail,
            }
            if item["status"] == "allowed":
                results["allowed"].append(result)
            else:
                results["conditional"].append(result)

    # 사용 불가 항목 검색
    for item in PROHIBITED_ITEMS:
        name_match = query_lower in item["name"].lower()
        keyword_match = any(query_lower in kw.lower() for kw in item["keywords"])
        if name_match or keyword_match:
            results["prohibited"].append({
                "name": item["name"],
                "status": "prohibited",
                "reason": item["reason"],
                "category_id": None,
                "category_name": "해당 없음",
                "legal_detail": {
                    "상위법": "산업안전보건법 제72조",
                    "고시": "고용노동부고시 제2025-11호 제7조 (사용 불가 사항)",
                    "관련조항": [item["reason"]],
                },
            })

    return results
